{% import '_macros/02_components/_assets' as assets %}

{% for section in builder.all() %}

    {% switch section.type %}
    
        {% case 'sectionBlock' %}
            {% set sectionTitle = section.sectionAnchor.sectionBookmarkTitle|slugify %}
            {% set sectionBlocks = builder.level(2).all() %}

            <section id="{{ sectionTitle }}">
                {# Section blocks #}
                {% for block in sectionBlocks %}
                    {% set config  = {
                        'content': block,
                        'variant': 'feature',
                        'reversed': true
                    } %}
                    {% include "_partials/_modules/_card.twig" with { config: config } only %}
    {# 
                    {% if block.type == 'featuredStrategyAndGrantees' %}
                    {% endif %} #}
                
                    {# Simplify component handling by leveraging naming conventions #
                    {% set camel   = b.type %}
                    {% set arr     = camel|dasherize|split('-') %}
                    {# Set macro name, e.g. "card" #
                    {% set macro   = arr[0] %}
                    {# Set macro variant name, e.g. "feature"  #
                    {% set variant = arr[1] %}
                    {# Create config object, as needed #
                    {% set config  = {
                        'content': b,
                        'variant': variant
                    } %}
                    {{ macro }}
                    {# {{ config }} #}
                    {# Call the abstracted _module template, which then calls _macro template:
                        _card, _carousel, _feed, _highlight, _text, or _timeline
                    #
                    {% include "_partials/_modules/_#{macro}.twig" with { config: config } only %}
    #}
                {% endfor %}
            </section>

        {% case 'prefooterForm' %}

    {% endswitch %}
{% endfor %}